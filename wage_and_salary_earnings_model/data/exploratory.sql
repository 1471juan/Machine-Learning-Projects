SELECT A_MJIND, AVG(WSAL_VAL)
FROM pppub
WHERE CAST(WSAL_VAL AS NUMERIC)>0
GROUP BY A_MJIND
ORDER BY CAST(WSAL_VAL AS NUMERIC) DESC; 


SELECT A_HGA, A_MJIND, AVG(WSAL_VAL), COUNT(*) as individuals FROM pppub
WHERE CAST(WSAL_VAL AS NUMERIC) > 0
GROUP BY A_MJIND,A_HGA
ORDER BY CAST(WSAL_VAL AS NUMERIC) DESC;


SELECT CASE
    WHEN CAST(A_SEX AS NUMERIC) = 1 THEN 'Men'
    WHEN CAST(A_SEX AS NUMERIC) = 2 THEN 'Women'
    ELSE 'Other'
    END AS Gender,
     AVG(WSAL_VAL)
FROM pppub
WHERE CAST(WSAL_VAL AS NUMERIC)>0
GROUP BY A_SEX
ORDER BY WSAL_VAL DESC;


SELECT 
    A_MJIND,
    CASE
        WHEN CAST(A_SEX AS NUMERIC) = 1 THEN 'Men'
        WHEN CAST(A_SEX AS NUMERIC) = 2 THEN 'Women'
        ELSE 'Other'
    END AS Gender,
    AVG(CAST(WSAL_VAL AS NUMERIC)) AS avg_wage,
    COUNT(*) AS n_individuals
FROM pppub
WHERE CAST(WSAL_VAL AS NUMERIC) > 0
GROUP BY A_MJIND, Gender
ORDER BY A_MJIND, avg_wage DESC;


SELECT A_AGE FROM pppub;
SELECT AVG(CAST (A_AGE AS NUMERIC)) AS avg_age, MAX(CAST(A_AGE AS NUMERIC)) as max_age
FROM pppub;


SELECT WSAL_VAL, A_AGE, A_SEX, A_MJIND, A_HGA
FROM pppub
WHERE CAST(WSAL_VAL AS NUMERIC) > (
    SELECT AVG(CAST(WSAL_VAL AS NUMERIC))
    FROM pppub
    WHERE CAST(WSAL_VAL AS NUMERIC) > 0
) ORDER BY WSAL_VAL ASC;


